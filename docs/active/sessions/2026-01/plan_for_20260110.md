# Dev-SWA Testing and Verification Plan
**Date:** January 10, 2026  
**Status:** üü¢ **READY FOR TESTING** - Dev-SWA Backend Deployed Successfully  
**Session Focus:** Comprehensive testing of dev-swa to verify feature parity with local dev

---

## Session Context

### Major Accomplishment: Dev-SWA Backend Deployment Success ‚úÖ

**Date:** January 9, 2026  
**Status:** ‚úÖ **SUCCESSFUL** - Backend running and responding

**What Was Fixed:**
1. ‚úÖ **Removed node_modules archive extraction approach** - Reverted to direct `node_modules` deployment (proven reliable)
2. ‚úÖ **Simplified package.json start scripts** - Removed extraction logic, back to simple `node dist/index.js`
3. ‚úÖ **Updated GitHub Actions workflows** - Both `dev-be.yaml` and `prod-be.yaml` now use direct deployment
4. ‚úÖ **Added path filters** - Documentation-only commits no longer trigger deployments
5. ‚úÖ **Backend health check** - Confirmed responding at `https://dev-api.traccems.com/health` (HTTP 200)
6. ‚úÖ **Login verified** - Successfully logged in as `admin@tcc.com`

**Key Technical Decisions:**
- **Direct `node_modules` deployment** chosen over archive extraction (reliable, proven approach)
- **Path filters** implemented to prevent unnecessary deployments from documentation changes
- **Deployment guide** created/updated with comprehensive deployment knowledge

**Current State:**
- **Backend:** ‚úÖ Running and responding (`https://dev-api.traccems.com`)
- **Frontend:** ‚úÖ Deployed (`https://dev-swa.traccems.com`)
- **Database:** ‚úÖ Connected (Azure dev database)
- **Login:** ‚úÖ Working (`admin@tcc.com` confirmed)

**Git Status:**
- **Latest Commit:** `740285ee` - "docs: Remove consolidated deployment docs - USER VERIFIED WORKING"
- **Backup:** ‚úÖ Complete backup created (`tcc-backup-20260109_151613`)
- **Working Tree:** ‚úÖ Clean

---

## Primary Objective: Verify Dev-SWA Feature Parity

**Goal:** Systematically test dev-swa (`https://dev-swa.traccems.com`) to ensure it has the same functionality as local dev (`http://localhost:3000`).

**Why This Matters:**
- Dev-swa is the staging environment before production
- Any discrepancies between dev-swa and local dev could indicate deployment or configuration issues
- Need confidence that dev-swa accurately represents what will be deployed to production

**Testing Approach:**
- Use comprehensive checklist: `docs/active/sessions/2026-01/checklist_20260109_dev_comparison.md`
- Test systematically, one module at a time
- Document any discrepancies found
- Fix drift issues before proceeding with production deployment

---

## Pre-Testing: Database Drift Check

### ‚ö†Ô∏è CRITICAL: Check for Database Drift Before Testing

**Reference:** See `docs/reference/azure/deployment-guide.md` - "Pre-Testing Drift Check" section

**Why:** Testing is meaningless if database schema doesn't match. Fix drift issues first to ensure accurate testing.

**Quick Pre-Testing Checklist (5-10 minutes):**

1. **Connect to Dev-SWA Database via pgAdmin:**
   - Use connection details from Azure Portal or GitHub Secrets (`DATABASE_URL`)
   - Connect to `traccems-dev-pgsql` database

2. **Check Critical Tables Exist:**
   ```sql
   SELECT table_name 
   FROM information_schema.tables 
   WHERE table_schema = 'public'
   ORDER BY table_name;
   ```
   - Compare with expected tables from Prisma schema
   - Key tables to verify: `trips`, `agency_responses`, `dropdown_options`, `dropdown_categories`, `healthcare_locations`, `ems_agencies`

3. **Check Critical Columns Exist:**
   ```sql
   -- Example: Check trips table has essential columns
   SELECT column_name 
   FROM information_schema.columns 
   WHERE table_name = 'trips'
   ORDER BY column_name;
   ```
   - Verify key columns exist (compare with local dev)

4. **Quick Functionality Test:**
   - ‚úÖ Can login (already confirmed)
   - ‚úÖ Can navigate to main pages
   - ‚úÖ No immediate 500 errors on page load

**If Pre-Testing Check Reveals Issues:**
- ‚ö†Ô∏è **Missing critical tables/columns** ‚Üí Fix drift BEFORE testing (see pgAdmin guidance below)
- ‚ö†Ô∏è **Obvious schema mismatches** ‚Üí Fix drift BEFORE testing
- ‚úÖ **Minor differences** ‚Üí Can proceed with testing, note for later

**Time Investment:** 5-10 minutes for quick check vs. hours of testing that might fail due to drift.

---

## Database Drift Resolution: Using pgAdmin

### When to Use pgAdmin During Testing

**Reference:** See `docs/reference/azure/deployment-guide.md` - "Database Migrations: When to Use pgAdmin" section

**Key Principle:** Not all drift symptoms require immediate stopping. It depends on the severity and impact.

#### üõë STOP Testing and Fix Immediately If:

1. **Critical Functionality Broken:**
   - ‚úÖ Cannot create trips (missing `trips` table or critical columns)
   - ‚úÖ Cannot dispatch (missing `agency_responses` table)
   - ‚úÖ Cannot login (missing user tables)
   - ‚úÖ 500 errors on core features
   - **Reason:** Testing is meaningless if core features don't work

2. **Widespread Schema Mismatches:**
   - ‚úÖ Multiple tables missing
   - ‚úÖ Many columns missing across multiple tables
   - ‚úÖ Database structure fundamentally different
   - **Reason:** Fixing drift will likely resolve multiple test failures

3. **Migration Errors During Deployment:**
   - ‚úÖ "Column already exists" errors
   - ‚úÖ "Migration already applied" errors
   - ‚úÖ Deployment failing due to migration conflicts
   - **Reason:** This indicates active drift that will block future deployments

#### ‚ö†Ô∏è Continue Testing But Document If:

1. **Non-Critical Features Affected:**
   - ‚úÖ Advanced features not working (analytics, reporting)
   - ‚úÖ Optional features missing (notifications, preferences)
   - ‚úÖ Features that aren't part of core workflow
   - **Action:** Continue testing core functionality, document issues for later fix

2. **Minor Column Differences:**
   - ‚úÖ Missing optional columns (timestamps, metadata)
   - ‚úÖ Extra columns that don't break functionality
   - ‚úÖ Naming convention differences (if handled by Prisma @map)
   - **Action:** Continue testing, note differences for later alignment

### pgAdmin Migration Process

**Reference:** See `docs/reference/azure/deployment-guide.md` - "pgAdmin Migration Process" section

**Quick Steps:**
1. **Connect to Azure Database** - Use pgAdmin with Azure connection details
2. **Assess Current State** - Check migration status and schema
3. **Apply Migrations Incrementally** - One migration at a time, verify after each
4. **Verify Final State** - Compare with dev-swa expected schema

**Best Practices:**
- Always backup first
- Test locally first
- Apply incrementally (one at a time)
- Document manual changes
- Verify after each step

---

## Testing Plan: Dev-SWA vs Local Dev

### Testing Checklist Reference

**Primary Reference:** `docs/active/sessions/2026-01/checklist_20260109_dev_comparison.md`

This comprehensive checklist covers:
1. Authentication & Login
2. TCC Dashboard (Admin) - Core Features
3. Healthcare Dashboard Features
4. EMS Dashboard Features
5. API Endpoints Verification
6. UI/UX Consistency
7. Database Functionality
8. Real-time Features
9. Performance

### Recommended Testing Order

1. ‚úÖ **Pre-Testing Drift Check** (5-10 minutes)
   - Verify critical tables/columns exist
   - Quick smoke test (login, navigate)

2. **Authentication** (5 minutes)
   - ‚úÖ Login as `admin@tcc.com` (already confirmed)
   - Test Healthcare user login
   - Test EMS user login
   - Test logout and session persistence

3. **TCC Dashboard Navigation** (10 minutes)
   - Verify all menu items work
   - Test navigation between pages
   - Check Overview page loads correctly

4. **Create Trip Workflow** (15 minutes)
   - End-to-end trip creation
   - Verify all form fields populate
   - Verify trip appears in list after creation
   - Test trip details view

5. **Healthcare Dashboard Tabs** (20 minutes)
   - Test all tabs load correctly
   - Verify transport requests display
   - Test in-progress trips
   - Test completed trips
   - Verify dispatch functionality

6. **EMS Dashboard Functionality** (15 minutes)
   - Verify trip acceptance/completion
   - Test available trips display
   - Verify trip status updates

7. **Analytics/Reporting** (10 minutes)
   - Verify data displays correctly
   - Test filters and date ranges

8. **Settings/Configuration** (10 minutes)
   - Verify all settings pages work
   - Test configuration changes

**Total Estimated Time:** ~1.5-2 hours for comprehensive testing

### Side-by-Side Comparison Method

**Best Practice:** Open both environments simultaneously for direct comparison

1. **Open Local Dev:** `http://localhost:3000`
2. **Open Dev-SWA:** `https://dev-swa.traccems.com`
3. **Log into both** with the same credentials
4. **Navigate through the same features** in parallel
5. **Compare:**
   - Same menu items?
   - Same form fields?
   - Same data displayed?
   - Same behavior?

**Key Differences to Expect:**
- ‚úÖ Different data (dev-swa uses Azure dev database, local uses local database)
- ‚úÖ Different URLs (localhost vs dev-swa.traccems.com)
- ‚úÖ Same functionality should be **identical**

---

## Red Flags to Watch For

If you see any of these, dev-swa may not match local dev:

- ‚ùå Missing menu items or tabs
- ‚ùå Forms missing fields
- ‚ùå Dropdowns not populating
- ‚ùå Features that work locally but not on dev-swa
- ‚ùå Different UI layouts or styling
- ‚ùå Console errors that don't appear locally
- ‚ùå API endpoints returning 404 or 500
- ‚ùå Different behavior for same actions
- ‚ùå Missing validation or error handling
- ‚ùå Performance issues not present locally

---

## Testing Workflow

### Step 1: Pre-Testing Setup

1. **Ensure Local Dev is Running:**
   ```bash
   ./scripts/start-dev-complete.sh
   # or
   npm run dev
   ```

2. **Verify Dev-SWA is Accessible:**
   - Frontend: `https://dev-swa.traccems.com`
   - Backend: `https://dev-api.traccems.com/health` (should return 200)

3. **Perform Pre-Testing Drift Check:**
   - Connect to dev-swa database via pgAdmin
   - Run quick schema verification queries
   - Fix any critical drift issues before proceeding

### Step 2: Systematic Testing

1. **Follow Testing Checklist:**
   - Use `docs/active/sessions/2026-01/checklist_20260109_dev_comparison.md`
   - Test each section systematically
   - Check off items as you verify them

2. **Document Issues:**
   - Note any discrepancies found
   - Categorize by severity (critical, high, medium, low)
   - Document steps to reproduce

3. **Handle Drift Issues:**
   - If critical drift found ‚Üí Stop testing, fix drift using pgAdmin
   - If non-critical drift found ‚Üí Document, continue testing
   - Reference deployment guide for pgAdmin migration process

### Step 3: Post-Testing

1. **Document Test Results:**
   - Update checklist with test results
   - Create summary of issues found
   - Prioritize fixes needed

2. **Fix Identified Issues:**
   - Critical issues ‚Üí Fix immediately
   - High priority ‚Üí Fix before production deployment
   - Medium/Low priority ‚Üí Fix when convenient

3. **Re-test After Fixes:**
   - Re-test affected features
   - Verify fixes resolved issues
   - Update checklist

---

## Key Documents Reference

### Primary Testing Resources

1. **Testing Checklist:**
   - `docs/active/sessions/2026-01/checklist_20260109_dev_comparison.md`
   - Comprehensive feature-by-feature checklist

2. **Deployment Guide:**
   - `docs/reference/azure/deployment-guide.md`
   - Contains pgAdmin migration guidance
   - Database drift resolution procedures
   - Pre-testing drift check steps

3. **Status Check:**
   - `docs/active/sessions/2026-01/STATUS_CHECK_20260109.md`
   - Current state of dev-swa environment

### Deployment Knowledge

- **Deployment Guide:** `docs/reference/azure/deployment-guide.md`
  - Critical deployment rules
  - Node modules deployment strategy
  - Automatic deployment triggers
  - Troubleshooting procedures
  - Database migrations (pgAdmin guidance)

---

## Success Criteria

### Testing Complete When:

- ‚úÖ All checklist items verified (or documented as not applicable)
- ‚úÖ No critical discrepancies found between dev-swa and local dev
- ‚úÖ All core functionality works correctly
- ‚úÖ Any drift issues identified and resolved
- ‚úÖ Test results documented

### Ready for Production Deployment When:

- ‚úÖ Dev-swa testing complete and successful
- ‚úÖ All critical issues resolved
- ‚úÖ Feature parity confirmed between dev-swa and local dev
- ‚úÖ Database drift resolved (if any found)
- ‚úÖ Deployment guide reviewed for production alignment

---

## Next Steps After Testing

### If Testing Reveals Issues:

1. **Categorize Issues:**
   - Critical (blocks core functionality)
   - High (affects important features)
   - Medium (affects optional features)
   - Low (cosmetic/minor)

2. **Fix Critical Issues First:**
   - Use pgAdmin for database drift issues
   - Fix code issues if needed
   - Re-test after fixes

3. **Document All Issues:**
   - Update checklist with findings
   - Create issue summary document
   - Track resolution progress

### If Testing is Successful:

1. **Document Success:**
   - Update checklist with completion status
   - Create testing summary
   - Mark dev-swa as verified

2. **Proceed to Production:**
   - Review production deployment plan
   - Verify production alignment with dev-swa
   - Begin production deployment process

---

## Important Notes

### Database Drift Guidance

**Reference:** `docs/reference/azure/deployment-guide.md` - "Database Migrations: When to Use pgAdmin"

**Key Points:**
- Always check for drift BEFORE comprehensive testing
- Use pgAdmin when automated migrations fail
- Apply migrations incrementally (one at a time)
- Verify after each migration
- Document any manual changes

### Deployment Rules

**Reference:** `docs/reference/azure/deployment-guide.md` - "Critical Rules"

**Key Rules:**
- Never push while deployment is in progress
- Wait for deployments to complete (~5-10 minutes)
- Batch commits when possible
- Check deployment status before pushing

### Testing Best Practices

- Test systematically, don't skip steps
- Document everything (what works, what doesn't)
- Compare side-by-side with local dev
- Fix drift issues before continuing testing
- Re-test after fixes

---

## Questions to Answer During Testing

1. **Does dev-swa have all the same features as local dev?**
   - Compare feature lists
   - Verify all menu items exist
   - Check all forms have same fields

2. **Do features work the same way?**
   - Test core workflows
   - Verify behavior matches local dev
   - Check for any differences

3. **Are there any database drift issues?**
   - Compare schemas
   - Check for missing tables/columns
   - Verify data relationships work

4. **Are there any deployment-specific issues?**
   - Check for environment variable issues
   - Verify API endpoints work
   - Test database connectivity

5. **Is dev-swa ready for production deployment?**
   - All critical issues resolved?
   - Feature parity confirmed?
   - Database drift resolved?

---

## Session Goals

### Primary Goals

1. ‚úÖ **Complete comprehensive testing** of dev-swa
2. ‚úÖ **Verify feature parity** with local dev
3. ‚úÖ **Identify and resolve** any drift issues
4. ‚úÖ **Document test results** and findings

### Secondary Goals

1. ‚úÖ **Update documentation** with test results
2. ‚úÖ **Fix any issues** found during testing
3. ‚úÖ **Prepare for production** deployment (if testing successful)

---

**Status:** üü¢ Ready to begin testing  
**Next Action:** Perform pre-testing drift check, then begin systematic testing using checklist  
**Estimated Time:** 1.5-2 hours for comprehensive testing

---

**Last Updated:** January 9, 2026  
**Created For:** January 10, 2026 session
